    ret = bt_passkey_set(123456);

    if (ret < 0) {
        LOG_ERR("Call `bt_passkey_set` failed: %d", ret);
        return ret;
    }

    ret = shell_bt_nus_init();


config MCUMGR_SMP_BT_AUTHEN
	default y if HIO_BLE

config MCUMGR_SMP_SHELL
	default y if HIO_BLE

config BT_FIXED_PASSKEY
    default y if HIO_BLE





_________________________________
CONFIG_RESET_ON_FATAL_ERROR




_____________________________

static int erase_storage(void)
{
	const struct device *dev;

	dev = device_get_binding(DT_CHOSEN_ZEPHYR_FLASH_CONTROLLER_LABEL);

	return flash_erase(dev, FLASH_AREA_OFFSET(storage),
			   FLASH_AREA_SIZE(storage));
}



_________________________________

From prj.conf.ble:

CONFIG_BT_CTLR_RX_PRIO_STACK_SIZE=2048
CONFIG_BT_CTLR_TX_PWR_PLUS_8=y
CONFIG_BT_CTLR=y
CONFIG_BT_DEVICE_APPEARANCE=0
CONFIG_BT_DEVICE_NAME_DYNAMIC=y
CONFIG_BT_DEVICE_NAME="CHESTER"
CONFIG_BT_MAX_CONN=4
CONFIG_BT_MAX_PAIRED=4
CONFIG_BT_PERIPHERAL_PREF_MAX_INT=16
CONFIG_BT_PERIPHERAL_PREF_MIN_INT=6
CONFIG_BT_PERIPHERAL_PREF_SLAVE_LATENCY=0
CONFIG_BT_PERIPHERAL_PREF_TIMEOUT=400
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_RX_STACK_SIZE=2048
CONFIG_BT_SMP=y
CONFIG_BT=y
CONFIG_SHELL_BT_NUS_RX_RING_BUFFER_SIZE=256
CONFIG_SHELL_BT_NUS_TX_RING_BUFFER_SIZE=256
CONFIG_SHELL_BT_NUS=y

# CONFIG_BT_NUS=y
# CONFIG_BT_DEVICE_APPEARANCE=833
# CONFIG_BT_DEVICE_NAME="CHESTER"
# CONFIG_BT_MAX_CONN=4
# CONFIG_BT_MAX_PAIRED=4
# CONFIG_BT_PERIPHERAL=y
# CONFIG_BT_SETTINGS=y
# CONFIG_BT_SMP=y
# CONFIG_BT=y
# CONFIG_FLASH_MAP=y
# CONFIG_FLASH_PAGE_LAYOUT=y
# CONFIG_FLASH=y
# CONFIG_NVS=y
# CONFIG_SETTINGS=y
# CONFIG_SHELL_BT_NUS_LOG_LEVEL_DBG=y
# CONFIG_SHELL_BT_NUS=y
